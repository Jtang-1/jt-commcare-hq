{% load hq_shared_tags %}
{% load i18n %}

<script type="text/template" id="case-view-item-template">
  <% if (isMultiSelect) { %>
    <td class="module-case-list-column-checkbox"><input type="checkbox" class="select-row-checkbox"/></td>
  <% } %>
  <% _.each(data, function(datum, index) { %>
    <% if (!(styles[index].widthHint === 0)) { %>
      <% if (styles[index].displayFormat === 'Image') { %>
        <td class="module-case-list-column"><img alt="<%- altText[index] %>" class="module-icon" src="<%- resolveUri(datum) %>"/></td>
      <% } else if (styles[index].displayFormat === 'ClickableIcon') { %>
        <td class="module-case-list-column">
          <button class="clickable-icon">
            <img alt="<%- altText[index] %>" class="module-icon" src="<%- resolveUri(datum) %>"/>
            <i class="fa fa-spin fa-spinner" style="display:none"></i>
          </button>
        </td>
      <% } else if (styles[index].displayFormat === 'Markdown') { %>
        <td class="module-case-list-column webapp-markdown-output"><%= renderMarkdown(datum) %></td>
      <% } else if (styles[index].displayFormat === 'Graph') { %>
        <td class="module-case-list-column"><iframe srcdoc="<%- datum %>" height="300" width="300"></iframe></td>
      <% } else { %>
        <td class="module-case-list-column"><%- datum %></td>
      <% } %>
    <% } %>
  <% }); %>
</script>

<script type="text/template" id="case-tile-view-item-template">
    <% if (isMultiSelect) { %>
      <div class="select-row-checkbox-div">
        <input type="checkbox" class="select-row-checkbox"/>
      </div>
    <% } %>

  <div class="<%- prefix %>-cell-grid-style collapsible-tile-content">
    <% _.each(data, function(datum, index) { %>
    <div class="<%- prefix %>-grid-style-<%- index %> box">
      <% if (styles[index].displayFormat === 'Image') {
      if(resolveUri(datum)) { %>
        <img alt="<%- altText[index] %>" class="module-icon" src="<%- resolveUri(datum) %>"/>
      <% } %>
      <% } else if (styles[index].displayFormat === 'ClickableIcon') {
      if(resolveUri(datum)) { %>
        <button class="clickable-icon">
          <img alt="<%- altText[index] %>" class="module-icon" src="<%- resolveUri(datum) %>"/>
          <i class="fa fa-spin fa-spinner" style="display:none"></i>
        </button>
      <% } %>
      <% } else if(styles[index].widthHint === 0) { %>
        <div style="display:none;"><%- datum %></div>
      <% } else { %>
        <div class="webapp-markdown-output"><%= renderMarkdown(datum) %></div>
      <% } %>
    </div>
    <% }); %>
  </div>
</script>

<script type="text/template" id="case-tile-grouped-view-item-template">
  <% if (isMultiSelect) { %>
    <div class="select-row-checkbox-div">
      <input type="checkbox" class="select-row-checkbox"/>
    </div>
  <% } %>

  <div class="group-data collapsible-tile-content">
    <div class="<%- prefix %>-cell-grid-style">
      <% for (let [index, datum] of Object.entries(indexedHeaderData)) { %>
        <div class="<%- prefix %>-grid-style-<%- index %> box" >
          <% if (styles[index].displayFormat === 'ClickableIcon') {
          if(resolveUri(datum)) { %>
            <button class="clickable-icon">
              <img alt="<%- altText[index] %>" class="module-icon" src="<%- resolveUri(datum) %>" style="max-width:100%; max-height:100%;"/>
              <i class="fa fa-spin fa-spinner" style="display:none"></i>
            </button>
          <% } %>
          <% } else if (styles[index].displayFormat === 'Image') {
          if(resolveUri(datum)) { %>
            <img alt="<%- altText[index] %>" class="module-icon" style="max-width:100%; max-height:100%;" src="<%- resolveUri(datum) %>"/>
          <% } %>
          <% } else if(styles[index].widthHint === 0) { %>
            <div style="display:none;"><%- datum %></div>
          <% } else { %>
            <div class="webapp-markdown-output"><%= renderMarkdown(datum) %></div>
          <% } %>
        </div>
      <% }; %>
    </div>

    <div class="group-rows">
      <% _.each(indexedRowDataList, function(indexedRowData) { %>
        <div class="<%- prefix %>-cell-grid-style group-row">
          <% for (let index in indexedRowData) { %>
            <% let datum = indexedRowData[index]; %>
            <div class="<%- prefix %>-grid-style-<%- index %> box">
              <% if (styles[index].displayFormat === 'Image') {
                if(resolveUri(datum)) { %>
                  <img alt="<%- altText[index] %>" class="module-icon" style="max-width:100%; max-height:100%;" src="<%- resolveUri(datum) %>"/>
                <% } %>
              <% } else if (styles[index].displayFormat === 'ClickableIcon') {
                if(resolveUri(datum)) { %>
                  <button class="clickable-icon">
                    <img alt="<%- altText[index] %>" class="module-icon" src="<%- resolveUri(datum) %>" style="max-width:100%; max-height:100%;"/>
                    <i class="fa fa-spin fa-spinner" style="display:none"></i>
                  </button>
                <% } %>
              <% } else { %>
                  <div class="webapp-markdown-output"><%= renderMarkdown(datum) %></div>
              <% } %>
            </div>
          <% } %>
        </div>
      <% }); %>
    </div>
  </div>
</script>

<script type="text/template" id="case-view-list-detail-template">
  <div class="module-case-list-container">
    <div class="module-case-list-table-container">
      <table class="table module-table module-table-case-list">
        <thead>
        <tr>
          <% _.each(headers, function(header, index) { %>
          <% if (!(styles[index].widthHint === 0)) { %>
          <th class="module-case-list-header"> <%= header %></th>
          <% } %>
          <% }); %>
        </tr>
        </thead>
        <% if (hasNoItems) { %>
        <tbody>
        <tr>
          <td class="module-case-list-column module-case-list-column-empty" colspan="<%-headers.length%>">
            <div class="alert alert-info">{% trans "List is empty." %}</div>
          </td>
        </tr>
        </tbody>
        <% } %>
        <tbody class="wrapper js-case-container">
        </tbody>
      </table>
    </div>
  </div>
</script>

<script type="text/template" id="case-view-tile-detail-template">
  <section class="js-case-container clearfix list-cell-container-style"></section>
</script>
